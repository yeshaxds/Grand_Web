# Spring Cloud 微服务系统使用说明

## 🚀 快速开始

### 1. 启动后端服务

#### 方式一：使用启动脚本（推荐）
```bash
cd Grand_Web/springcloud
.\start-all.bat
``` 

#### 方式二：手动启动
按照以下顺序启动服务：

1. **启动 Eureka 服务注册中心**
   ```bash
   cd eureka-server
   mvn spring-boot:run
   ```
   等待服务完全启动（看到启动成功日志）

2. **启动用户服务**
   ```bash
   cd user-service
   mvn spring-boot:run
   ```

3. **启动产品服务**
   ```bash
   cd product-service
   mvn spring-boot:run
   ```

4. **启动网关**
   ```bash
   cd gateway
   mvn spring-boot:run
   ```

### 2. 启动前端服务

在 `Grand_Web/web` 目录下：
```bash
npm run serve
# 或
npm run dev
```

### 3. 访问系统

- **前端页面**: http://localhost:3000 (或您配置的端口)
- **Spring Cloud 管理页面**: 前端页面 → 导航到 `/spring-cloud`

## 📋 服务端口说明

| 服务名称 | 端口 | 访问地址 | 说明 |
|---------|------|---------|-----|
| Eureka Server | 8761 | http://localhost:8761 | 服务注册中心 |
| Gateway | 8080 | http://localhost:8080 | API 网关 |
| User Service | 8081 | http://localhost:8081 | 用户服务 |
| Product Service | 8082 | http://localhost:8082 | 产品服务 |

## 🎯 功能特性

### 1. 服务监控
- 实时显示所有微服务的运行状态
- 自动检测服务健康状况
- 显示 Eureka 注册信息
- 提供监控工具链接

### 2. 用户管理
- 查看所有用户列表
- 添加新用户
- 编辑用户信息
- 删除用户
- 支持完整的 CRUD 操作

### 3. 产品管理
- 查看所有产品列表
- 按分类筛选产品
- 搜索产品
- 添加新产品
- 编辑产品信息
- 删除产品
- 库存管理

## 🔧 API 接口

### 通过网关访问（推荐）

#### 用户相关接口
- `GET /api/users` - 获取所有用户
- `GET /api/users/{id}` - 获取指定用户
- `POST /api/users` - 创建用户
- `PUT /api/users/{id}` - 更新用户
- `DELETE /api/users/{id}` - 删除用户
- `GET /api/users/info` - 获取用户服务信息

#### 产品相关接口
- `GET /api/products` - 获取所有产品
- `GET /api/products/{id}` - 获取指定产品
- `GET /api/products/category/{category}` - 按分类获取产品
- `GET /api/products/search?name={name}` - 搜索产品
- `POST /api/products` - 创建产品
- `PUT /api/products/{id}` - 更新产品
- `DELETE /api/products/{id}` - 删除产品
- `GET /api/products/info` - 获取产品服务信息

### 直接访问微服务
如果网关未启动，也可以直接访问微服务：
- 用户服务：`http://localhost:8081/users/*`
- 产品服务：`http://localhost:8082/products/*`

## 🗄️ 数据库访问

### H2 数据库控制台

**用户服务数据库**
- 访问地址：http://localhost:8081/h2-console
- JDBC URL：`jdbc:h2:mem:userdb`
- 用户名：`sa`
- 密码：`password`

**产品服务数据库**
- 访问地址：http://localhost:8082/h2-console
- JDBC URL：`jdbc:h2:mem:productdb`
- 用户名：`sa`
- 密码：`password`

## ⚠️ 注意事项

1. **启动顺序很重要**：必须先启动 Eureka，再启动微服务，最后启动网关

2. **端口占用**：确保 8761、8080、8081、8082 端口未被占用

3. **Java 版本**：确保安装了 Java 8 或更高版本

4. **Maven**：确保安装了 Maven 并配置了环境变量

5. **网络问题**：如果无法访问，检查防火墙设置

6. **CORS**：所有服务都已配置 CORS，支持跨域访问

## 🛠️ 故障排除

### 问题1：服务启动失败
- 检查端口是否被占用
- 查看控制台错误日志
- 确认 Java 和 Maven 环境是否正确

### 问题2：前端无法连接后端
- 确认所有后端服务都已启动
- 检查服务状态（Eureka 控制台）
- 验证网关是否正常工作

### 问题3：数据库连接失败
- H2 是内存数据库，重启服务后数据会重置
- 检查 H2 控制台连接参数是否正确

### 问题4：Eureka 中看不到服务
- 检查服务配置中的 Eureka 地址
- 确认服务启动后等待一段时间（注册需要时间）
- 查看服务日志中的注册信息

## 🎨 技术栈

### 后端
- Spring Boot 2.7.14
- Spring Cloud 2021.0.8
- Spring Data JPA
- H2 Database
- Netflix Eureka
- Spring Cloud Gateway

### 前端
- Vue 3
- Vue Router
- Pinia
- Composition API
- ES6+

## 📞 技术支持

如果遇到问题，请检查：
1. 控制台日志
2. Eureka 控制台（http://localhost:8761）
3. 网络连接状态
4. 服务端口占用情况

希望您使用愉快！🎉 